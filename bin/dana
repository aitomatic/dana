#!/bin/bash
# Launch the DANA REPL with variable reference fixes applied
# This script enables self-references like "private.a = private.a + 1" to work correctly

# Find the script directory
script_dir="$(dirname "$(realpath "$0")")"
cd $script_dir/..

# Activate the virtual environment if it exists and not already activated
if [ -f "./source_venv.sh" ] && [ -z "$VIRTUAL_ENV" ]; then
    echo "Activating virtual environment..."
    source ./source_venv.sh
fi

# Run the REPL
echo "Starting DANA REPL with variable reference fixes..."
echo "You can now use expressions like 'a = a + 1' where a is a local variable"
exec python opendxa/dana/repl/dana_repl_app.py "$@"
